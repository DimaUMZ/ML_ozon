# OZON Recommendation System Project

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
ozon/
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ ml_ozon_recsys_test_for_participants/     # –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îî‚îÄ‚îÄ processed/                                # –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ features/                                 # Feature Engineering
‚îÇ   ‚îú‚îÄ‚îÄ models/                                   # –ú–æ–¥–µ–ª–∏ ML
‚îÇ   ‚îî‚îÄ‚îÄ evaluation/                               # –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–µ–π
‚îú‚îÄ‚îÄ notebooks/                                    # Jupyter –Ω–æ—É—Ç–±—É–∫–∏
‚îú‚îÄ‚îÄ config/                                       # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ scripts/                                      # –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞
‚îî‚îÄ‚îÄ requirements.txt                              # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```

## üöÄ –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—É—Å–∫–∞

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
python -m venv venv

# –ê–∫—Ç–∏–≤–∞—Ü–∏—è (Linux/Mac)
source venv/bin/activate

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt
```

### 2. –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
python scripts/check_data.py

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö
python scripts/explore_data.py
```

### 3. Feature Engineering

```bash
# –û—Å–Ω–æ–≤–Ω–æ–π –ø–∞–π–ø–ª–∞–π–Ω –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Ñ–∏—á–µ–π
python src/features/build_features.py

# –° –æ–ø—Ü–∏—è–º–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –Ω–∞—á–∞–ª–∞)
python src/features/build_features.py --sample_size 100000

# –¢–æ–ª—å–∫–æ –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
python src/features/data_loader.py --analyze_only
```

### 4. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π

```bash
# –ë–∞–∑–æ–≤–æ–µ –æ–±—É—á–µ–Ω–∏–µ (–Ω–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö)
python src/models/train_model.py

# –° —É–º–µ–Ω—å—à–µ–Ω–Ω—ã–º –æ–±—ä–µ–º–æ–º –¥–∞–Ω–Ω—ã—Ö
python src/models/train_model.py --sample_size 100000

# –° –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–æ–π –∫–ª–∞—Å—Å–æ–≤
python src/models/train_model.py --sample_size 100000 --balance_classes

# –¢–æ–ª—å–∫–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏
python src/models/train_model.py --models logistic lightgbm
```

### 5. –û—Ü–µ–Ω–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

```bash
# –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –æ–±—É—á–µ–Ω–∏—è
python src/evaluation/analyze_results.py

# –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
python src/evaluation/compare_models.py

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫
python src/evaluation/plot_metrics.py
```

## ‚öôÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—É—Å–∫–∞

### –î–ª—è build_features.py
```bash
--sample_size N          # –†–∞–∑–º–µ—Ä —Å—ç–º–ø–ª–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: –≤—Å–µ –¥–∞–Ω–Ω—ã–µ)
--output_path PATH       # –ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
--skip_validation        # –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é
```

### –î–ª—è train_model.py
```bash
--sample_size N          # –†–∞–∑–º–µ—Ä —Å—ç–º–ø–ª–∞ (100000, 500000)
--balance_classes        # –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∫–ª–∞—Å—Å–æ–≤
--models TYPE            # –ú–æ–¥–µ–ª–∏: all, logistic, forest, lightgbm
--test_size RATIO        # –†–∞–∑–º–µ—Ä —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏ (0.2)
```

## üîß –£—Ç–∏–ª–∏—Ç—ã

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
python scripts/check_environment.py
```

### –ü–æ–∏—Å–∫ –¥–∞–Ω–Ω—ã—Ö
```bash
python scripts/find_data_files.py
```

### –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
```bash
python scripts/clean_processed_data.py
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ—Ü–µ—Å—Å–∞

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
```bash
# –í —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
tail -f logs/processing.log

# –°—Ç–∞—Ç—É—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏
python scripts/check_status.py
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
```bash
# –ü–∞–º—è—Ç—å –∏ CPU
python scripts/monitor_resources.py

# –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
time python src/features/build_features.py --sample_size 100000
```

## üêõ –ü–æ–∏—Å–∫ –∏ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ï—Å–ª–∏ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –ø–∞–º—è—Ç–∏
```bash
# –£–º–µ–Ω—å—à–∏—Ç–µ —Ä–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö
python src/features/build_features.py --sample_size 50000

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–æ–ª–µ–µ –ª–µ–≥–∫–∏–µ –º–æ–¥–µ–ª–∏
python src/models/train_model.py --models logistic --sample_size 50000
```

### –ï—Å–ª–∏ –æ—à–∏–±–∫–∏ –∏–º–ø–æ—Ä—Ç–∞
```bash
# –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt --force-reinstall

# –ò–ª–∏ –æ–±–Ω–æ–≤–∏—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø–∞–∫–µ—Ç
pip install --upgrade pandas scikit-learn
```

### –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è
```bash
# –ü–æ–∏—Å–∫ parquet —Ñ–∞–π–ª–æ–≤
python scripts/find_parquet_files.py

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—É—Ç–µ–π –≤ –∫–æ–Ω—Ñ–∏–≥–µ
python scripts/check_config_paths.py
```

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–π workflow

1. **–°–Ω–∞—á–∞–ª–∞ –º–∞–ª–µ–Ω—å–∫–∏–π —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç:**
```bash
python src/features/build_features.py --sample_size 100000
python src/models/train_model.py --sample_size 100000 --balance_classes
```

2. **–ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ö–æ—Ä–æ—à–∏–µ - –º–∞—Å—à—Ç–∞–±–∏—Ä—É–π—Ç–µ:**
```bash
python src/features/build_features.py --sample_size 500000
python src/models/train_model.py --sample_size 500000
```

3. **–ü–æ–ª–Ω—ã–π –∑–∞–ø—É—Å–∫:**
```bash
python src/features/build_features.py
python src/models/train_model.py
```

## üìà –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

- **ROC-AUC > 0.7** - –Ω–µ–ø–ª–æ—Ö–æ
- **ROC-AUC > 0.8** - —Ö–æ—Ä–æ—à–æ  
- **ROC-AUC > 0.9** - –æ—Ç–ª–∏—á–Ω–æ
- **ROC-AUC ~0.5** - –∫–∞–∫ —Å–ª—É—á–∞–π–Ω–æ–µ —É–≥–∞–¥—ã–≤–∞–Ω–∏–µ

## üí° –°–æ–≤–µ—Ç—ã

1. –ù–∞—á–∏–Ω–∞–π—Ç–µ —Å –º–∞–ª–µ–Ω—å–∫–∏—Ö sample sizes
2. –°–Ω–∞—á–∞–ª–∞ –¥–æ–±–µ–π—Ç–µ—Å—å ROC-AUC > 0.7 –Ω–∞ small data
3. –ü–æ—Ç–æ–º –º–∞—Å—à—Ç–∞–±–∏—Ä—É–π—Ç–µ –Ω–∞ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
4. –õ–æ–≥–∏—Ä—É–π—Ç–µ –≤—Å–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã
5. –°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –ª—É—á—à–∏–µ –º–æ–¥–µ–ª–∏

## üÜò –ï—Å–ª–∏ –≤—Å–µ —Å–ª–æ–º–∞–ª–æ—Å—å

```bash
# –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –∏ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞
rm -rf venv/
rm -rf data/processed/
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt
python src/features/build_features.py --sample_size 50000
```

**–õ—É—á—à–∞—è –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è —Å—Ç–∞—Ä—Ç–∞:**
```bash
python src/features/build_features.py --sample_size 100000
python src/models/train_model.py --sample_size 100000 --balance_classes
```